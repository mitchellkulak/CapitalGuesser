<!DOCTYPE html>
<html>

<head>
    <title>Capital Guesser | Login</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body>

    <div id="navBar">
        <h1 id="title">World Capital Guesser</h1>
        <ul>
            <li><a href="index.html">Game</a></li>
            <li><a href="score.html">High Scores</a></li>
            <li><a href="profile.html">Profile</a></li>
            <li><a href="login.html">Login</a></li>
        </ul>
    </div>

    <form id="login">
        <label>Username</label>
        <input type="text" id="username">
        <label>Password</label>
        <input type="text" id="password">
        <input type="button" id="btnLogin" value="Login">
    </form>


    <button onclick = "googleSignin()">Google Signin</button>
<button onclick = "googleSignout()">Google Signout</button>

    <script src="https://www.gstatic.com/firebasejs/5.5.9/firebase.js"></script>
    
    <script>
        var config = {
            apiKey: "AIzaSyApQJhDBdHM_OPLpiYG5jr6bYNgeH0Oqmo",
            authDomain: "capitalguesser-98105.firebaseapp.com",
            databaseURL: "https://capitalguesser-98105.firebaseio.com",
            projectId: "capitalguesser-98105",
            storageBucket: "capitalguesser-98105.appspot.com",
            messagingSenderId: "211259741975"
        };
        firebase.initializeApp(config);
        var UserDatabaseRef = firebase.database().ref("Users");

        var provider = new firebase.auth.GoogleAuthProvider();

function googleSignin() {
   firebase.auth()
   
   .signInWithPopup(provider).then(function(result) {
      var token = result.credential.accessToken;
      var user = result.user;
		
      console.log(token)
      console.log(user)
   }).catch(function(error) {
      var errorCode = error.code;
      var errorMessage = error.message;

      console.log(error.code)
      console.log(error.message)
   });
}

function googleSignout() {
   firebase.auth().signOut()
	
   .then(function() {
      console.log('Signout Succesfull')
   }, function(error) {
      console.log('Signout Failed')  
   });
}


firebase.auth().onAuthStateChanged(function(user) {
  if (user) {
    // User is signed in.
    var displayName = user.displayName;
    var email = user.email;
    var emailVerified = user.emailVerified;
    var photoURL = user.photoURL;
    var isAnonymous = user.isAnonymous;
    var uid = user.uid;
    console.log("SIGNED IN - " + uid);
    var providerData = user.providerData;
    // ...
    var obj = {};
    obj.email = email;
    obj.uid = uid;
    obj.userName = displayName;
    obj.high_score = 1;
    UserDatabaseRef.push(obj);
    document.cookie = "currentUser=" + uid;
  } else {
    // User is signed out.
    // ...
  }
});

    </script>

</body>

</html>
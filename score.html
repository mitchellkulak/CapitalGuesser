<!DOCTYPE html>
<html>

<head>
    <title>Capital Guesser | High Scores</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body onload="CreateTable()">

    <div id="navBar">
        <ul>
            <li>Game</li>
            <li>High Score</li>
            <li>Profile</li>
        </ul>
    </div>

    <div id="scoreTable"></div>

    <script src="https://www.gstatic.com/firebasejs/5.5.9/firebase.js"></script>

    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyApQJhDBdHM_OPLpiYG5jr6bYNgeH0Oqmo",
            authDomain: "capitalguesser-98105.firebaseapp.com",
            databaseURL: "https://capitalguesser-98105.firebaseio.com",
            projectId: "capitalguesser-98105",
            storageBucket: "capitalguesser-98105.appspot.com",
            messagingSenderId: "211259741975"
        };
        firebase.initializeApp(config);
        var UserDatabaseRef = firebase.database().ref("Users");

        // Retrieve new posts as they are added to our database
        UserDatabaseRef.on("child_added", function (snapshot, prevChildKey) {
            var newPost = snapshot.val();
            console.log(newPost.username);
            console.log(newPost.high_score);

            allKeys.push(snapshot.key);

            var newRow = document.createElement('TR');
            newRow.id = snapshot.key;

            var newCell1 = document.createElement('TD');
            newCell1.innerHTML = newPost.name;

            var newCell2 = document.createElement('TD');
            newCell2.innerHTML = newPost.high_score;

            newRow.appendChild(newCell1);
            newRow.appendChild(newCell2);

            var thisTableBody = document.getElementById("tbodyID");
            thisTableBody.appendChild(newRow);

            var thisTable = document.getElementById("thisTable");
            thisTable.appendChild(thisTableBody);

            var friendObj = new Object();
            friendObj.name = newPost.username;
            friendObj.phone = newPost.high_score;
            allFriends.push(friendObj);
            console.log(friendObj);
        });

        function CreateTable() {
            //Div
            const myTableDiv = document.getElementById("theDiv");

            //table
            const myTable = document.createElement("table");
            myTable.id = 'thisTable';

            //table body
            var tbody = document.createElement("tbody");
            tbody.id = "tbodyID";

            //header row
            var row1 = document.createElement('TR');

            //Username heading
            var h1 = document.createElement('TH');
            h1.innerHTML = 'Username';
            row1.appendChild(h1);

            //score heading
            var h2 = document.createElement('TH');
            h2.innerHTML = 'Score';
            row1.appendChild(h2);

            //add header row to table
            myTable.appendChild(row1);

            //add tbody to table
            myTable.appendChild(tbody);

            //add table to div 
            myTableDiv.appendChild(myTable);
        }
    </script>

</body>

</html>